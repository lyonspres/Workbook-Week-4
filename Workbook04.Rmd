---
output:
  word_document: default
  html_document: default
---
```{r libraries}
if (!require(skimr)) install.packages('skimr')
if (!require(lubridate)) install.packages('lubridate')
if (!require(tidyverse)) install.packages('tidyverse')
if (!requireNamespace("devtools")) {
  install.packages("devtools")
}
if (!require(easystats)) devtools::install_github("easystats/easystats")
```
```{r lib2}
if (!require(ggthemes)) install.packages('ggthemes')
if (!require(pmdplyr)) install.packages("pmdplyr")
if (!require(kableExtra)) install.packages("kableExtra")
```

## Import Data

```{r data1}
nz_0 <- 
  readr::read_csv2(
    url("https://raw.githubusercontent.com/go-bayes/psych-447/main/data/nz/nz.csv")
    )
```

```{r data2}
f<-c("None Of The Time",
     "A Little Of The Time",
     "Some Of The Time",
     "Most Of The Time",
     "All Of The Time")
```

```{r tidy}
if (!require(tidyverse)) install.packages('tidyverse')
```

```{r data3}
nz <- nz_0 %>%
  dplyr::mutate_if(is.character, factor) %>%
  select(
    -c(
      SWB.Kessler01,
      SWB.Kessler02,
      SWB.Kessler03,
      SWB.Kessler04,
      SWB.Kessler05,
      SWB.Kessler06
    )
  ) %>%
  dplyr::mutate(Wave = as.factor(Wave)) %>%
  mutate(FeelHopeless = forcats::fct_relevel(FeelHopeless, f)) %>%
  mutate(FeelDepressed = forcats::fct_relevel(FeelDepressed, f)) %>%
  mutate(FeelRestless = forcats::fct_relevel(FeelRestless, f)) %>%
  mutate(EverythingIsEffort = forcats::fct_relevel(EverythingIsEffort, f)) %>%
  mutate(FeelWorthless = forcats::fct_relevel(FeelWorthless, f)) %>%
  mutate(FeelNervous = forcats::fct_relevel(FeelNervous, f)) %>%
  dplyr::mutate(Wave = as.factor(Wave)) %>%
  dplyr::mutate(date = make_date(year = 2009, month = 6, day = 30) + TSCORE)
```

Question 1
## Integer

```{r camtaylor}
nz %>%
  select(contains("hour"))
```
```{r integer22}
nz2 <- nz %>%
  mutate(Hours.Internet_int = as.integer(Hours.Internet),
  Hours.Exercise_int = as.integer(Hours.Exercise),
  Hours.Work_int = as.integer(Hours.Work),
  Hours.News_int = as.integer(Hours.News),
  HoursCharity_int = as.integer(HoursCharity))
```

```{r STD}
str(nz2)
```

Question 2a
## Scale, Center, Transform

```{r imsadrn}
nz3 <- nz2 %>%
  select(Pol.Orient, Age)%>%
  mutate(Pol.Orient1 = scale(Pol.Orient, scale = TRUE, center  = TRUE)) %>%
  mutate(Pol.Orient2 = scale(Pol.Orient, scale = FALSE, center = TRUE)) %>%
  mutate(Age1 = scale(Age, scale = FALSE, center  = TRUE)/10)
head(nz3)
```
Question 2b
## Data Wrangle

```{r wrangle}
nz4 <- nz %>%
  select(Hours.Exercise, Wave) %>%
  mutate(Hours.Exercise44 = scale(Hours.Exercise, scale = TRUE, center  = TRUE)) %>%
  filter(Wave !="2019")

## Compare

summary(nz4$Hours.Exercise44)
summary(nz4$Wave)

nz4
```

Question 3
## Working with dates

```{r wannagoonadate}
nz5 <- nz %>%
  dplyr::mutate(date = make_date(year = 2018, year = 2019) + TSCORE)
```

What are the maximum number of responses for a single day in 2018 and the maximum number of responses for a single day in 2019?

Question 4
## Calculating dates and creating summaries

Question 5
## Working with date intervals

```{r jordanandparis}
int<-lubridate::interval(ymd_hms("1995-12-25-05-02-22"), ymd_hms("2021-03-20-13-22-04"))
time_length(int, "month")
```

Question 6
## Create an ordered factor from numerical data

```{r factor3452}
nz7 <-nz %>%
  dplyr::mutate(relicats = cut(
    Religion.Church,
    breaks = c(-Inf, 0, 4, Inf),  
    labels = c("Non-attendance", "Moderate attendance", "Frequent attendance"), 
    right = TRUE
  ))
table(nz$relicats, useNA = "ifany")
```

*Make sure to re-level the factor so that the ordinal ranking moves from lowest to highest
??

Question 7a
## Make a summary table

```{r liahelper}
nz5 <- nz %>%
  select(date, HLTH.SleepHours) %>%
  mutate(Months = month(date, label = TRUE)) %>%
  group_by(Months) %>%
  arrange(Months)
```

```{r kablekable}
library(kableExtra)
nz5 %>%
  select(HLTH.SleepHours, Months) %>%
  filter(!is.na(HLTH.SleepHours))%>%
  group_by(Months) %>%
  summarise(av_sleep = mean(HLTH.SleepHours, na.rm = T))%>%
  pivot_wider(names_from = Months, values_from = av_sleep) %>%
  kbl(caption = "Average Number of Hours of Sleep by Month") %>%
   kable_classic_2(c("striped", "hover"), full_width = TRUE) %>%
  collapse_rows()
```

Question 7b
## Make a summary graph

```{r graph_1}
m0 <- glm("av_sleep" ~ Months, data = nz5 ) %>%
parameters::model_parameters(m0)
```

Question 8
## Correlation graph

```{r corrgraph}
nz8 <- nz %>%
  mutate(FeelHopeless_int = as.integer(FeelHopeless),
  FeelDepressed_int = as.integer(FeelDepressed),
  FeelRestless_int = as.integer(FeelRestless),
  EverythingIsEffort_int = as.integer(EverythingIsEffort),
  FeelWorthless_int = as.integer(FeelWorthless),
  FeelNervous_int = as.integer(FeelNervous))
```

```{r corrgraph2}
moodnz <- nz%>%
  select(
    FeelHopeless,
    FeelDepressed,
    FeelRestless,
    EverythingIsEffort,
    FeelWorthless,
    FeelNervous,
    Id
  ) %>%
  mutate_all(., as.numeric) %>% #make numeric 
  mutate(Id = as.factor(Id),
         FeelNervous = log(FeelNervous + 1))
```

```{r correr23r5}
library(correlation)
library(ggraph)
p1<-moodnz %>%
  correlation(partial = FALSE, multilevel = TRUE ) %>%
  plot()
```

```{r corrfinal}
moodnz %>%
  correlation(partial = FALSE, multilevel = TRUE ) %>%
  summary()
```
```{r anothercorr}
library(correlation)
p2<-moodnz %>%
  select(-Id)%>% # get rid of grouping variable
  correlation(partial = FALSE, multilevel = FALSE ) %>%
  plot()
```

```{r anotherone}
moodnz %>%
  select(-Id)%>% # get rid of grouping variable
  correlation(partial = FALSE, multilevel = FALSE ) %>%
  summary()
```
```{r plotplot}
library(patchwork)
# create a two panel plot
p1 / p2 + 
  plot_annotation(title = "Plot of multilevel (a) and single-level (b) correlation", tag_levels = 'a')
windowsFonts("Arial" = windowsFont("Arial"))
```

What do you find most interesting about this plot? The strong correclations present between feeling worthless, depressed, and hopeless. 

Question 9
## Create a blank papaja report

* Package ‘papaja’ is not available for this version of R

Question 10
## Patchwork



